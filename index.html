<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Anita, will you be my Valentine?</title>
  <style>
    :root{
      --bg-error: #0b0b0f;
      --bg-pink: #ffb6c9;
      --accent: #ff4d6d;
    }

   body{
  margin:0;
  font-family: Arial, sans-serif;
  text-align:center;
  color:white;
  background: var(--bg-error);
  transition: background 0.5s;
  overflow:hidden;
}

/* screens must be full-screen layers */
.screen{
  position: fixed;
  inset: 0;
  display: none;
  padding: 24px;
  box-sizing: border-box;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  gap: 10px;
}

.active{ display:flex; }

    /* Page 1 */
    .error-img{
      height:20vh;          /* ~20% of screen height */
      width:auto;
      max-width:70vw;
      object-fit:contain;
      margin-bottom:6px;
    }

    h2{
      margin:0;
      font-size:1.4rem;
      font-weight:700;
    }

    .msg{
      margin:6px 0 0 0;
      opacity:0.9;
      line-height:1.35;
      max-width:560px;
    }

    .hint{
      margin-top:10px;
      font-size:0.95rem;
      opacity:0.75;
      max-width:560px;
      line-height:1.35;
    }

    input{
      margin-top:14px;
      padding:12px 14px;
      font-size:1rem;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.15);
      outline:none;
      text-align:center;
      width:min(360px, 90%);
      background: rgba(255,255,255,0.08);
      color:white;
    }

    input::placeholder{
      color: rgba(255,255,255,0.6);
    }

    button{
      margin-top:12px;
      padding:10px 26px;
      font-size:1rem;
      border:none;
      border-radius:999px;
      background: var(--accent);
      color:white;
      cursor:pointer;
      transition: transform 0.2s;
    }

    button:hover{ transform: scale(1.05); }

    .wrong{
      display:none;
      margin-top:10px;
      color: var(--accent);
      font-size:0.95rem;
    }

    /* Page 2 */
    .val-title{
      margin:0 0 8px 0;
      font-size: clamp(2rem, 5vw, 3.2rem);
      line-height:1.1;
    }

    .sub{
      margin:0;
      font-size:1.1rem;
      opacity:0.95;
    }
  /* ===== PAGE 2 NEW LAYOUT ===== */
#mainSite{
  position: relative;
  background: var(--bg-pink);
}

/* photos appear here */
#photoLayer{
  position: absolute;
  inset: 0;
  z-index: 1;
  pointer-events: none;
}
    
#thinkTimer{
  position: fixed;
  z-index: 9999999;
  font-weight: 1000;
  font-size: 48px;
  padding: 10px 14px;
  border-radius: 16px;
  background: rgba(0,0,0,0.65);
  color: white;
}

/* button + gif stay on top and must never be covered */
#centerUI{
  position: relative;
  z-index: 9999;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 18px;
  padding: 18px;
}

/* pastel pink button in the middle */
#surpriseBtn{
  background: #f7a8c7;   /* pastel pink */
  color: #fff;
  font-size: 1.05rem;
  padding: 14px 26px;
  border: none;
  border-radius: 999px;
  cursor: pointer;
  box-shadow: 0 8px 20px rgba(0,0,0,0.18);
}

#surpriseBtn:hover{
  transform: scale(1.05);
}

/* gif placeholder area */
#miniGif{
  width: 160px;     /* change later */
  height: 160px;    /* change later */
  object-fit: contain;
  background: rgba(255,255,255,0.15);
  border-radius: 18px;
}

/* Counter */
#clickCounter{
  font-size: 1rem;
  color: white;
  opacity: 0.95;
}

/* Move on button (white w/ black text) */
#moveOnBtn{
  background: white;
  color: black;
  border: none;
  border-radius: 16px;
  padding: 12px 16px;
  max-width: min(560px, 92vw);
  font-size: 0.95rem;
  cursor: pointer;
  box-shadow: 0 10px 25px rgba(0,0,0,0.18);
}

#progressWrap{
  width: 260px;
  display:flex;
  flex-direction: column;
  align-items:center;
  gap: 12px;
}

#progressBubble{
  position: relative;
  width: 240px;      /* bubble size NEVER changes */
  height: 18px;
  border-radius: 999px;
  background: rgba(255,255,255,0.25);
  overflow: hidden;
}

#progressBar{
  position:absolute;
  left:0;
  top:0;
  height:100%;
  width:0%;
  border-radius:999px;
  background:#00c853;
}

#progressText{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:0.85rem;
  color:white;
  user-select:none;
}

#progressMsg{
  font-weight:700;
  font-size:14px;
  line-height:1.3;
  color:white;
  text-align:center;
  width: 260px;
}

/* ===== STORY PAGES (3+) ===== */
.storyPage{
  position: fixed;
  inset: 0;
  z-index: 200000;
  background: var(--bg-pink);
  display: flex;
  align-items: center;
  justify-content: center;
}


.storyCenter{
  width: 100%;
  max-width: 900px;
  margin: 0 auto;
}


.storyText{
  color: white;
  font-size: 25px;
  text-align: center;
  max-width: min(680px, 92vw);
  line-height: 1.35;
}

/* black next button bottom-right */
.nextBtn{
  position: absolute;
  right: 18px;
  bottom: 18px;
  background: #000;
  color: #fff;
  border: none;
  border-radius: 999px;
  padding: 12px 18px;
  font-size: 0.95rem;
  cursor: pointer;
}
.backBtn{
  position: absolute;
  left: 18px;
  bottom: 18px;
  background: #000;
  color: #fff;
  border: none;
  border-radius: 999px;
  padding: 12px 18px;
  font-size: 0.95rem;
  cursor: pointer;
}
#page12 { position: relative; } /* so the overlays anchor properly */

#gameTimer{
  position: absolute;
  top: 18px;
  left: 18px;
  font-size: 28px;
  font-weight: 800;
  padding: 8px 12px;
  border-radius: 12px;
  background: rgba(255,255,255,0.85);
  z-index: 50;
}

#gameScore{
  position: absolute;
  top: 18px;
  right: 18px;
  font-size: 28px;
  font-weight: 800;
  padding: 8px 12px;
  border-radius: 12px;
  background: rgba(255,255,255,0.85);
  z-index: 50;
}
    
#gameTimer, #gameScore{
  background: black;
  color: white;
}

#gameArea{
  position: relative;
  width: min(720px, 88vw);
  height: 420px;
  margin-top: 18px;
  border-radius: 18px;
  background: rgba(255,255,255,0.25);
  overflow: hidden;
}

#targetBtn{
  position: absolute;
  padding: 14px 18px;
  font-size: 18px;
  border-radius: 14px;
  cursor: pointer;
}

#gameMsg{
  position: absolute;
  bottom: 14px;
  left: 14px;
  right: 14px;
  font-size: 18px;
  font-weight: 700;
}
    

.storyGif{
  width: 300px !important;   /* adjust size here */
  height: auto !important;
  max-width: 90%;


.muteBtn{
  position: fixed;
  left: 18px;
  bottom: 18px;
  z-index: 999999;
  padding: 10px 14px;
  border-radius: 14px;
  font-weight: 800;
  cursor: pointer;
}


/* YouTube modal */
.ytModal{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.65);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 99999;
}

.ytBox{
  width: min(900px, 92vw);
  background: white;
  border-radius: 18px;
  padding: 14px;
  position: relative;
}

.ytTitle{
  font-weight: 900;
  margin: 6px 0 10px;
  font-size: 18px;
}

.ytClose{
  position: absolute;
  right: 10px;
  top: 8px;
  font-size: 24px;
  font-weight: 900;
  background: transparent;
  border: none;
  cursor: pointer;
}
/* PAGE 14 big question text */
.valentineBigText{
  font-size: clamp(28px, 4vw, 54px);
  font-weight: 900;
  text-align: center;
  margin-bottom: 22px;
  line-height: 1.05;
}

/* Buttons layout */
.valButtonsRow{
  display: flex;
  gap: 16px;
  justify-content: center;
  align-items: center;
  margin-bottom: 14px;
  position: static;   /* IMPORTANT: stop being a positioning parent */
  z-index: 5;
}


.valBtn{
  padding: 14px 22px;
  border-radius: 18px;
  font-weight: 900;
  font-size: 18px;
  cursor: pointer;
}

.yesBtn{
  transform-origin: center;
}

.noBtn{
  position: relative; /* will become absolute after first "No" press */
  transform-origin: center;
}

.thinkBtn{
  margin-top: 6px;
  font-size: 16px;
  padding: 12px 18px;
  border-radius: 18px;
  position: relative;
  z-index: 5;
}

.thinkMsg{
  margin-top: 14px;
  font-weight: 800;
  text-align: center;
  min-height: 24px;
  position: relative;
  z-index: 5;
}


.yesGif{
  width: 20vh;
  height: auto;
  max-width: 220px;
}

.valPhoto{
  width: min(520px, 88vw);
  height: auto;
  max-height: 52vh;
  object-fit: contain;
  border-radius: 18px;
  background: rgba(255,255,255,0.15);
}


/* "No" sadness overlay + dullness */
#page14{ position: relative; overflow: hidden; }

#noOverlay{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0);
  pointer-events:none;
  z-index: 200001;
}

#rainLayer{
  position: fixed;
  inset: 0;
  pointer-events:none;
  z-index: 200002;
}



/* simple raindrop */
.rainDrop{
  position: absolute;
  top: -20px;
  width: 2px;
  height: 18px;
  background: rgba(255,255,255,0.65);
  animation: rainFall linear infinite;
}

@keyframes rainFall{
  from { transform: translateY(0); }
  to   { transform: translateY(120vh); }
}
  

  </style>
</head>
<body>

  <button id="muteBtn" class="muteBtn">Mute ðŸ”‡</button>



  <!-- PAGE 1: ERROR + PASSWORD -->
  <div id="lockScreen" class="screen active">
    <img class="error-img" src="error.png" alt="Error screen" />

      <h2>Something went wrong</h2>
    <p class="msg">
      This page is protected.<br>
      Please enter the password to continue.
    </p>

    <input id="pw" type="password" placeholder="Password" autocomplete="off" autocapitalize="none" spellcheck="false" />
    <button id="continueBtn">Continue</button>

    <p class="hint">
      (hint: the animal that appears everywhere in your life, from arcades to games to your spirit animal)
    </p>

    <div id="wrong" class="wrong">Incorrect password</div>
  </div>

  <!-- PAGE 2: PINK VALENTINE PAGE -->
<div id="mainSite" class="screen">

  <!-- This layer is where the random photos will appear -->
  <div id="photoLayer"></div>

  <!-- Center UI (button + gif space). Photos must NOT cover this. -->
  <div id="centerUI">
    <div id="clickCounter">Clicks: 0</div>
    <button id="moveOnBtn" style="display:none;">
  ok fine you have proven that you LOVE seeing cute pictures of us, you can move on now if you want
</button>
    <button id="surpriseBtn">click me for a surprise or two</button>

    <!-- GIF SPACE: replace the src later -->
    <img id="miniGif" src="capy1.gif" alt="capybara gif" />
 <div id="progressWrap">
  <div id="progressBubble">
    <div id="progressBar"></div>
    <div id="progressText">0%</div>
  </div>
  <div id="progressMsg"></div>
</div>


  <audio id="music" loop>
    <source src="song.mp3" type="audio/mpeg">
  </audio>
  <!-- PAGE 3 -->
<div id="page3" class="storyPage" style="display:none;">
  <div class="storyCenter">
    <div class="storyText">So the purpose of this website wasnt really to spawn a ton of art.</div>
    <img class="storyGif" src="capy2.gif" alt="">
  </div>
  <button class="backBtn" id="back3">Back</button>
  <button class="nextBtn" id="next3">Next</button>
</div>

<!-- PAGE 4 -->
<div id="page4" class="storyPage" style="display:none;">
  <div class="storyCenter">
    <div class="storyText">Although I did love staring at your beauty in all the pieces.</div>
    <img class="storyGif" src="capy3.gif" alt="">
  </div>
  <button class="backBtn" id="back4">Back</button>
  <button class="nextBtn" id="next4">Next</button>
</div>

<!-- PAGE 5 -->
<div id="page5" class="storyPage" style="display:none;">
  <div class="storyCenter">
    <div class="storyText">I guess the purpose of this website was to connect heart to heart. </div>
    <img class="storyGif" src="capy4.gif" alt="">
  </div>
  <button class="backBtn" id="back5">Back</button>
  <button class="nextBtn" id="next5">Next</button>
</div>

<!-- PAGE 6 -->
<div id="page6" class="storyPage" style="display:none;">
  <div class="storyCenter">
    <div class="storyText">And new things fuels our love; I think that's the general thesis.</div>
    <img class="storyGif" src="capy5.gif" alt="">
  </div>
  <button class="backBtn" id="back6">Back</button>
  <button class="nextBtn" id="next6">Next</button>
</div>

<!-- PAGE 7 -->
<div id="page7" class="storyPage" style="display:none;">
  <div class="storyCenter">
    <div class="storyText">I got you something green, a reminder of our start.</div>
    <img class="storyGif" src="capy6.gif" alt="">
  </div>
  <button class="backBtn" id="back7">Back</button>
  <button class="nextBtn" id="next7">Next</button>
</div>

<!-- PAGE 8 -->
<div id="page8" class="storyPage" style="display:none;">
  <div class="storyCenter">
    <div class="storyText">I hope it stays with you forever, just like some adhesive.</div>
    <img class="storyGif" src="capy7.gif" alt="">
  </div>
  <button class="backBtn" id="back8">Back</button>
  <button class="nextBtn" id="next8">Next</button>
</div>

<!-- PAGE 9 -->
<div id="page9" class="storyPage" style="display:none;">
  <div class="storyCenter">
    <div class="storyText">Since you've been stuck in my life, it's been my favourite part.</div>
    <img class="storyGif" src="capy8.gif" alt="">
  </div>
  <button class="backBtn" id="back9">Back</button>
  <button class="nextBtn" id="next9">Next</button>
</div>

<!-- PAGE 10 -->
<div id="page10" class="storyPage" style="display:none;">
  <div class="storyCenter">
    <div class="storyText">I want to be glued to you, until the rhythm of our hearts ceases.</div>
    <img class="storyGif" src="capy9.gif" alt="">
  </div>
  <button class="backBtn" id="back10">Back</button>
  <button class="nextBtn" id="next10">Next</button>
</div>
  
<!-- PAGE 11 -->
<div id="page11" class="storyPage" style="display:none;">
  <div class="storyCenter">
    <div class="storyText">
      The purpose of this also wasn't for a poem either.<br>
      I actually made a fun game for you.
    </div>
    <img class="storyGif" src="capy10.gif" alt="">
  </div>
  <button class="backBtn" id="back11">Back</button>
  <button class="nextBtn" id="next11">Next</button>
</div>

<!-- PAGE 12 (GAME) -->
<div id="page12" class="storyPage" style="display:none;">
  <div id="gameTimer">10.000</div>
  <div id="gameScore">0</div>

  <div class="storyCenter">
    <div class="storyText">Click it before the timer hits 0 :) </div>

    <div id="gameArea">
      <button id="targetBtn" style="display:none;">CLICK ME</button>
      <div id="gameMsg"></div>
    </div>
  </div>

  <button class="backBtn" id="back12">Back</button>
  <button class="nextBtn" id="next12" style="display:none;">Next</button>
</div>

</div>
<!-- PAGE 13 -->
<div id="page13" class="storyPage" style="display:none;">
  <div class="storyCenter">
    <div class="storyText">
      Good job on the game, but that also wasnt the purpose of this whole thing<br>
      I actually just wanted to ask you one simple question :)
    </div>
  </div>
  <button class="backBtn" id="back13">Back</button>
  <button class="nextBtn" id="next13">Next</button>
</div>
<!-- PAGE 14 -->
<div id="page14" class="storyPage" style="display:none;">
  <!-- dark overlay + rain live here -->
  <div id="noOverlay"></div>
  <div id="rainLayer"></div>

  <div class="storyCenter">
    <div class="valentineBigText">Anita, will you be my Valentine?</div>

    <div class="valButtonsRow">
      <button id="yesBtn" class="valBtn yesBtn">Yes</button>
      <button id="noBtn" class="valBtn noBtn">No</button>
    </div>

    <button id="thinkBtn" class="valBtn thinkBtn">Hm, I'll think about it...</button>

    <div id="thinkMsg" class="thinkMsg"></div>
  </div>

  <button class="backBtn" id="back14">Back</button>
</div>
<!-- PAGE 15 (YES) -->
<div id="page15" class="storyPage" style="display:none;">
  <div class="storyCenter">
    
  <img class="yesGif" src="capy_yes.gif" alt="">
<img id="valPhoto" class="valPhoto" src="placeholder.jpg" alt="">
<div class="storyText">Thank you for saying yes. I love you Anita.</div>

  </div>

  <button class="backBtn" id="back15">Back</button>
</div>
<div id="ytModal" class="ytModal" style="display:none;">
  <div class="ytBox">
    <button id="closeYt" class="ytClose">Ã—</button>
    <div class="ytTitle">Ok. You earned this ðŸ˜­</div>
    <iframe
      id="ytFrame"
      width="560"
      height="315"
      src=""
      title="YouTube video"
      frameborder="0"
      allow="autoplay; encrypted-media"
      allowfullscreen>
    </iframe>
  </div>
</div>


  <script>
const music = document.getElementById("music");

const progressMilestones = [
  { p: 200, msg: "Why are you still pressing the button?" },
  { p: 250, msg: "HEY stop!" },
  { p: 350, msg: "Do you think theres some sort of secret that'll appear if you keep pressing it?" },
  { p: 500, msg: "Good job you hit 500, your reward is absoluetly nothing because THERE'S NO POINT OF PRESSING THE BUTTON PAST 100%." },
  { p: 600, msg: "Okay FINE, keep pressing it.... if you want." },
  { p: 670, msg: "You seriously thought I'd put something special at 67? Well you probably didn't think that but I did anyway :p" },
  { p: 700, msg: "I'm glad you kept pressing, that means you thought this whole thing wasn't just a 67 joke." },
  { p: 800, msg: "Are you seriously trying to reach 1000?" },
  { p: 900, msg: "You're at 900 now, that means you've pressed that same pink button 180 times. It also means that you've spawned 180 pictures of us :)" },
  { p: 1000, msg: "Good job you got to 1000. Happy now? Did that fuel your dopamine?" },
  { p: 1005, msg: "Well if it didn't then I hope this will â†“" },
  { p: 1010, msg: "I pinky promise this is the last bit of text, you can move on now" }
];

let lastMilestoneIndex = -1;
const progressMsgEl = document.getElementById("progressMsg");

  function checkProgressMilestones() {
  let newIndex = lastMilestoneIndex;

  for (let i = 0; i < progressMilestones.length; i++) {
    if (clickCount >= progressMilestones[i].p) newIndex = i;
  }

  if (newIndex !== lastMilestoneIndex && newIndex !== -1) {
    lastMilestoneIndex = newIndex;
    progressMsgEl.textContent = progressMilestones[newIndex].msg;

    if (progressMilestones[newIndex].p === 1005) {
      openYoutubeReward();
    }
  }
}

    const correctPassword = "capybara";

    const lockScreen = document.getElementById("lockScreen");
    const mainSite = document.getElementById("mainSite");
    const pw = document.getElementById("pw");
    const wrong = document.getElementById("wrong");
const muteBtn = document.getElementById("muteBtn");

if (muteBtn && music) {
  muteBtn.addEventListener("click", () => {
    music.muted = !music.muted;

    if (music.muted) {
      music.pause();
      muteBtn.textContent = "Unmute ðŸ”Š";
    } else {
      music.play().catch(() => {});
      muteBtn.textContent = "Mute ðŸ”‡";
    }
  });
}

    function unlock() {
      if (pw.value === correctPassword) {
        wrong.style.display = "none";

        lockScreen.classList.remove("active");
        mainSite.classList.add("active");

        // switch background to pink
        document.body.style.background = "var(--bg-pink)";

    // start music (allowed because user clicked Continue)
      music.muted = false;
music.currentTime = 0;
music.play().catch(() => {
  // If the browser blocks it for any reason, it will try again on the next click.
  document.addEventListener("click", () => music.play(), { once: true });
});
      } else {
  wrong.style.display = "block";
}
}  // âœ… add this line to close function unlock()

document.getElementById("continueBtn").addEventListener("click", unlock);

    pw.addEventListener("keydown", (e) => {
      if (e.key === "Enter") unlock();
    });
function openYoutubeReward() {
  // Opens the video in a new tab (simple + reliable)
  window.open("https://www.youtube.com/watch?v=kYcQ3M5Z6TQ", "_blank");
}

// ===== PAGE 2: Surprise button spawns random photos =====

// 1) Put your photo filenames here (upload them to the repo)
const photos = [
  "us (1).jpg",
  "us (2).jpg",
  "us (3).jpg",
  "us (4).jpg",
  "us (5).jpg",
  "us (6).jpg",
  "us (7).jpg",
  "us (8).jpg",
  "us (9).jpg",
  "us (10).jpg",
  "us (11).jpg",
  "us (12).jpg",
  "us (13).jpg",
  "us (14).jpg",
  "us (15).jpg",
  "us (16).jpg",
  "us (17).jpg",
  "us (18).jpg",
  "us (19).jpg",
  "us (20).jpg"
];


const photoLayer = document.getElementById("photoLayer");
const surpriseBtn = document.getElementById("surpriseBtn");
const miniGif = document.getElementById("miniGif");
const clickCounter = document.getElementById("clickCounter");
const progressBar = document.getElementById("progressBar");
const progressText = document.getElementById("progressText");
const moveOnBtn = document.getElementById("moveOnBtn");

// keep newest photo on top
let zCounter = 10;
let clickCount = 0;

// Photo size: about double the error image (error = 20vh, so ~40vh)
function getPhotoSizePx() {
  const h = Math.floor(window.innerHeight * 0.40); // 40% of viewport height
  return { w: h, h: h }; // square; change to {w: ..., h: ...} if you prefer
}

function randomPositionAvoidingCenterUI(imgW, imgH) {
  const bounds = photoLayer.getBoundingClientRect();   // use photoLayer coords
const btn = document.getElementById("surpriseBtn").getBoundingClientRect();
const gif = document.getElementById("miniGif").getBoundingClientRect();
  const pad = 12;
const safe = 140; // extra space around button/gif (tweak if needed)
  
  // Convert UI box into photoLayer-local coordinates
 const btnLocal = {
  left: (btn.left - bounds.left) - safe,
  top: (btn.top - bounds.top) - safe,
  right: (btn.right - bounds.left) + safe,
  bottom: (btn.bottom - bounds.top) + safe
};


const gifLocal = {
  left: (gif.left - bounds.left) - safe,
  top: (gif.top - bounds.top) - safe,
  right: (gif.right - bounds.left) + safe,
  bottom: (gif.bottom - bounds.top) + safe
};


  for (let i = 0; i < 600; i++) {
    const x = Math.floor(Math.random() * (bounds.width - imgW - pad * 2)) + pad;
    const y = Math.floor(Math.random() * (bounds.height - imgH - pad * 2)) + pad;

    const rect = { left: x, top: y, right: x + imgW, bottom: y + imgH };

    const overlapsBtn = !(
  rect.right < btnLocal.left ||
  rect.left > btnLocal.right ||
  rect.bottom < btnLocal.top ||
  rect.top > btnLocal.bottom
);

const overlapsGif = !(
  rect.right < gifLocal.left ||
  rect.left > gifLocal.right ||
  rect.bottom < gifLocal.top ||
  rect.top > gifLocal.bottom
);

const overlapsUI = overlapsBtn || overlapsGif;

    if (!overlapsUI) return { x, y };
  }

  return { x: pad, y: pad };
}
function progressColorFor(pct){
  // 0..100 = green (#00c853)
  // 100..200 = fades to red (#FF0000), then clamps
  if (pct <= 100) return "#00c853";
  const t = Math.min((pct - 100) / 100, 1); // 0..1
  const r = Math.round(0 + (255 - 0) * t);
  const g = Math.round(200 + (0 - 200) * t); // 200 -> 0
  const b = Math.round(83 + (0 - 83) * t);   // 83  -> 0
  return `rgb(${r}, ${g}, ${b})`;
}

function spawnPhoto() {
  if (!photos.length) return;
  clickCount += (clickCount >= 1000 ? 1 : 5);


// counter
clickCounter.textContent = `Clicks: ${clickCount}`;

// progress keeps increasing past 100
progressText.textContent = `${clickCount}%`;

// width grows forever (will spill off the bar once >100%)
progressBar.style.width = `${Math.min(clickCount, 100)}%`;

// color: green -> red as it exceeds 100 (clamps at pure red)
progressBar.style.background = progressColorFor(clickCount);


  checkProgressMilestones();

// show the move-on button at 100 clicks
if (clickCount >= 100) {
  moveOnBtn.style.display = "block";
}


  const { w, h } = getPhotoSizePx();
const pos = randomPositionAvoidingCenterUI(w, h);
console.log("spawnPhoto pos:", pos);


const img = document.createElement("img");
img.src = photos[Math.floor(Math.random() * photos.length)];
img.style.position = "absolute";
img.style.left = pos.x + "px";
img.style.top = pos.y + "px";
  img.style.width = w + "px";
  img.style.height = h + "px";
  img.style.objectFit = "cover";
  img.style.borderRadius = "18px";
  img.style.boxShadow = "0 12px 30px rgba(0,0,0,0.25)";
  img.style.zIndex = String(++zCounter); // newest on top

  photoLayer.appendChild(img);
}

surpriseBtn.addEventListener("click", spawnPhoto);
function showStoryPage(n){
  // hide the photo-click UI (page 2 stuff)
  document.getElementById("centerUI").style.display = "none";
  document.getElementById("photoLayer").style.display = "none";

  // show the requested story page
  const page = document.getElementById("page" + n);
  page.style.display = "flex";
}

function goToStoryPage(from, to){
  document.getElementById("page" + from).style.display = "none";
  document.getElementById("page" + to).style.display = "flex";
}

// Show page 3 when moveOn is clicked (music continues because we never remove <audio>)
moveOnBtn.addEventListener("click", () => showStoryPage(3));

// Next buttons
document.getElementById("next3").addEventListener("click", () => goToStoryPage(3, 4));
document.getElementById("next4").addEventListener("click", () => goToStoryPage(4, 5));
document.getElementById("next5").addEventListener("click", () => goToStoryPage(5, 6));
document.getElementById("next6").addEventListener("click", () => goToStoryPage(6, 7));
document.getElementById("next7").addEventListener("click", () => goToStoryPage(7, 8));
document.getElementById("next8").addEventListener("click", () => goToStoryPage(8, 9));
document.getElementById("next9").addEventListener("click", () => goToStoryPage(9, 10));
document.getElementById("next10").addEventListener("click", () => goToStoryPage(10, 11));

// Back buttons
document.getElementById("back3").addEventListener("click", () => {
  // go back to page 2 (photo page)
  document.getElementById("page3").style.display = "none";
  document.getElementById("centerUI").style.display = "flex";
  document.getElementById("photoLayer").style.display = "block";
});

document.getElementById("back4").addEventListener("click", () => goToStoryPage(4, 3));
document.getElementById("back5").addEventListener("click", () => goToStoryPage(5, 4));
document.getElementById("back6").addEventListener("click", () => goToStoryPage(6, 5));
document.getElementById("back7").addEventListener("click", () => goToStoryPage(7, 6));
document.getElementById("back8").addEventListener("click", () => goToStoryPage(8, 7));
document.getElementById("back9").addEventListener("click", () => goToStoryPage(9, 8));
document.getElementById("back10").addEventListener("click", () => goToStoryPage(10, 9));
document.getElementById("back11").addEventListener("click", () => goToStoryPage(11, 10));
document.getElementById("next12").addEventListener("click", () => goToStoryPage(12, 13));
document.getElementById("back13").addEventListener("click", () => goToStoryPage(13, 12));
document.getElementById("next13").addEventListener("click", () => goToStoryPage(13, 14));
document.getElementById("back14").addEventListener("click", () => {
  resetNoEffects();
  goToStoryPage(14, 13);
});

    // ===== PAGE 12 GAME =====
const page12 = document.getElementById("page12");
const timerEl = document.getElementById("gameTimer");
const scoreEl = document.getElementById("gameScore");
const targetBtn = document.getElementById("targetBtn");
const gameArea = document.getElementById("gameArea");
const gameMsg = document.getElementById("gameMsg");
const next12 = document.getElementById("next12");
const back12 = document.getElementById("back12");

let score = 0;

// Starting time (seconds). Set to whatever you want the first round to be.
let startTimeSec = 10.0;

// Each successful click reduces the next start time.
// Your example 10 -> 6.67 suggests multiplying by 2/3.
const decayFactor = 2 / 3;

// Donâ€™t let it get impossible
const minStartTimeSec = 0.25;

let roundStartMs = 0;
let rafId = null;
let gameActive = false;

function formatTime(sec) {
  // Show seconds + milliseconds: 04.237
  const s = Math.max(0, sec);
  const whole = Math.floor(s);
  const ms = Math.floor((s - whole) * 1000);
  return String(whole).padStart(2, "0") + "." + String(ms).padStart(3, "0");
}

function placeButtonRandomly() {
  // Ensure we have sizes (button must be displayed before measuring)
  const areaRect = gameArea.getBoundingClientRect();
  const btnRect = targetBtn.getBoundingClientRect();

  const maxX = Math.max(0, areaRect.width - btnRect.width);
  const maxY = Math.max(0, areaRect.height - btnRect.height);

  const x = Math.random() * maxX;
  const y = Math.random() * maxY;

  targetBtn.style.left = `${x}px`;
  targetBtn.style.top = `${y}px`;
}

function stopGameLoop() {
  if (rafId) cancelAnimationFrame(rafId);
  rafId = null;
}

function endGame() {
  gameActive = false;
  stopGameLoop();
  targetBtn.style.display = "none";
  gameMsg.textContent = `Timeâ€™s up ðŸ˜­ Final score: ${score}`;
  next12.style.display = "inline-block";
}

function startRound() {
  next12.style.display = "none";
  gameMsg.textContent = "";
  gameActive = true;

  // show button (must be visible before we can position accurately)
  targetBtn.style.display = "inline-block";
  placeButtonRandomly();

  // start timer
  roundStartMs = performance.now();

  // loop
  stopGameLoop();
  const loop = (now) => {
    if (!gameActive) return;

    const elapsedSec = (now - roundStartMs) / 1000;
    const remaining = startTimeSec - elapsedSec;

    timerEl.textContent = formatTime(remaining);

    if (remaining <= 0) {
      timerEl.textContent = "00.000";
      endGame();
      return;
    }

    rafId = requestAnimationFrame(loop);
  };

  rafId = requestAnimationFrame(loop);
}

function resetGame12() {
  score = 0;
  scoreEl.textContent = score;
  startTimeSec = 10.0; // initial round time
  extraPenaltySec = 0;  
  timerEl.textContent = formatTime(startTimeSec);
  gameMsg.textContent = "Get readyâ€¦";
  next12.style.display = "none";
  targetBtn.style.display = "none";
  gameActive = false;
  stopGameLoop();

  // Start immediately (or add a short delay if you want)
  startRound();
}

let extraPenaltySec = 0; // put this once near your other game variables

targetBtn.addEventListener("click", () => {
  if (!gameActive) return;

  score += 10;
  scoreEl.textContent = score;

  // Base decay
  startTimeSec = startTimeSec * decayFactor;

  // After 150 points, stack extra difficulty
  if (score >= 150) {
    extraPenaltySec += 0.05;
  }

  // Apply and clamp
  startTimeSec = Math.max(minStartTimeSec, startTimeSec - extraPenaltySec);

  // Restart instantly
  startRound();
});

// Hook navigation like your other pages
back12.addEventListener("click", () => {
  stopGameLoop();
  gameActive = false;
  goToStoryPage(12, 11);
});

// Start game whenever you enter page 12
document.getElementById("next11").addEventListener("click", () => {
  goToStoryPage(11, 12);
  resetGame12();
});

const page14 = document.getElementById("page14");
const yesBtn = document.getElementById("yesBtn");
const noBtn = document.getElementById("noBtn");
const thinkBtn = document.getElementById("thinkBtn");
const thinkMsg = document.getElementById("thinkMsg");
const noOverlay = document.getElementById("noOverlay");
const rainLayer = document.getElementById("rainLayer");

let noPresses = 0;
let yesScale = 1;
let noScale = 1;

let thinkInterval = null;
let thinkCleanupTimeout = null;

function randBetween(min, max){
  return Math.random() * (max - min) + min;
}

/* ===== YES ===== */
yesBtn.addEventListener("click", () => {
  resetNoEffects();
  clearThinkStuff();
  goToStoryPage(14, 15);
});

document.getElementById("back15").addEventListener("click", () => {
  goToStoryPage(15, 14);
});

/* ===== NO ===== */
function ensureNoAbsolute(){
  if (getComputedStyle(noBtn).position !== "fixed") {
    noBtn.style.position = "fixed";  // fixed = whole screen
  }
}

function moveNoRandom(){
  const pad = 20;

  // get real size AFTER scaling
  const rect = noBtn.getBoundingClientRect();
  const btnW = rect.width;
  const btnH = rect.height;

  const maxX = Math.max(pad, window.innerWidth - btnW - pad);
  const maxY = Math.max(pad, window.innerHeight - btnH - pad);

  const x = randBetween(pad, maxX);
  const y = randBetween(pad, maxY);

  noBtn.style.left = `${x}px`;
  noBtn.style.top = `${y}px`;

  // always above everything
  noBtn.style.zIndex = 9999999;
}


function addRainDrops(count){
  for (let i = 0; i < count; i++){
    const d = document.createElement("div");
    d.className = "rainDrop";
    d.style.left = `${Math.random() * 100}%`;
    d.style.animationDuration = `${randBetween(0.6, 1.4)}s`;
    d.style.opacity = `${randBetween(0.25, 0.8)}`;
    d.style.height = `${randBetween(12, 26)}px`;
    rainLayer.appendChild(d);
  }
}

function applyNoMood(){
  // darker & duller each press
  const darkness = Math.min(0.55, noPresses * 0.06);
  noOverlay.style.background = `rgba(0,0,0,${darkness})`;

  // dullness via filter on page content
  const sat = Math.max(0.35, 1 - noPresses * 0.08);
  const bright = Math.max(0.55, 1 - noPresses * 0.06);
  page14.style.filter = `saturate(${sat}) brightness(${bright})`;
}

noBtn.addEventListener("click", () => {
  noPresses++;

  // no gets smaller, yes gets bigger
  noScale = Math.max(0.25, noScale * 0.82);
  yesScale = Math.min(2.8, yesScale * 1.12);

  noBtn.style.transform = `scale(${noScale})`;
  yesBtn.style.transform = `scale(${yesScale})`;

  ensureNoAbsolute();
  moveNoRandom();

  applyNoMood();

  // more rain each press (starts small)
  addRainDrops(6 + noPresses * 4);
});

/* Reset when leaving/re-entering or hitting Yes */
function resetNoEffects(){
  noPresses = 0;
  yesScale = 1;
  noScale = 1;

  yesBtn.style.transform = "scale(1)";
  noBtn.style.transform = "scale(1)";

noBtn.style.position = "";
noBtn.style.left = "";
noBtn.style.top = "";
noBtn.style.zIndex = "";


  noOverlay.style.background = "rgba(0,0,0,0)";
  page14.style.filter = ""; // remove dull filter

  rainLayer.innerHTML = "";
}

/* ===== THINK ===== */
function clearThinkStuff(){
  if (thinkInterval) clearInterval(thinkInterval);
  if (thinkCleanupTimeout) clearTimeout(thinkCleanupTimeout);
  thinkInterval = null;
  thinkCleanupTimeout = null;

  const existingTimer = document.getElementById("thinkTimer");
  if (existingTimer) existingTimer.remove();

  thinkMsg.textContent = "";
}

thinkBtn.addEventListener("click", () => {
  clearThinkStuff();

  // create timer element at random position
  const t = document.createElement("div");
  t.id = "thinkTimer";
  t.textContent = "5";
  page14.appendChild(t);

  const rect = page14.getBoundingClientRect();
  t.style.left = `${randBetween(30, rect.width - 100)}px`;
  t.style.top  = `${randBetween(90, rect.height - 140)}px`;

  let remaining = 5;
  thinkInterval = setInterval(() => {
    remaining--;
    t.textContent = String(remaining);

    if (remaining <= 0) {
      clearInterval(thinkInterval);
      thinkInterval = null;

      thinkMsg.textContent = "I think that was more than enough thinking time. Well I hope it was :(";

      // remove timer + text after 5 seconds
      thinkCleanupTimeout = setTimeout(() => {
        clearThinkStuff();
      }, 5000);
    }
  }, 1000);
});

  </script>

</body>
</html>
